<!DOCTYPE html>
<html>
  <head>
    <title> fede's talk </title>

    <meta charset="utf-8">

    <script type="text/javascript" src="./scripts/remark-0.4.2.min.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>    
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML&delayStartupUntil=configured">

      remark.on('ready', function () {
        MathJax.Hub.Config({
          tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre']
          }
        });
        MathJax.Hub.Queue(function() {
          $(MathJax.Hub.getAllJax()).map(function(index, elem) {
            return(elem.SourceElement());
          }).parent().addClass('has-jax');
        });
        MathJax.Hub.Configured();
      });
    </script>

    <style>
      @font-face{
        font-family: 'Droid Serif';
        src: url('./fonts/DroidSerif.ttf');
      }
      @font-face{
        font-family: 'Yanone Kaffeesatz';
        src: url('./fonts/YanoneKaffeesatz-Regular.ttf');
      }
      @font-face{
        font-family: 'Ubuntu Mono';
        src: url('./fonts/UbuntuMono-Regular.ttf');
      }


      .preview-iframe {
          width: 100%;
          height: 100%;
          border: 0;

          max-width: 1280px;
          max-height: 720px;
          margin: auto;
      }

      /* Colors */
      .red    { color: #FF4943; }
      .gray   { color: #787878; }
	    .lgray  { color: #d9d9d9; }
      .green  { color: #87A558; }
      .blue   { color: #01C8A0; }
      .yellow { color: #DBEC62; }

      body { font-family: 'Droid Serif'; }
      img.right { max-width: 100%; display: block; margin-left: auto; margin-right: auto; vertical-align: middle; }
      
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: normal;        
      }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
      
      .inverse { background: #272822; color: #777872;}
      .inverse h1, .inverse h2 { color: #f3f3f3; line-height: 0.8em; }

      .footnote{ position: absolute; bottom: 2em; font-size: 0.8em; color: blue; float: right}
      
      /* Two-column layout */
      .small-left-column { width: 35%; float: left; }
      .big-right-column { width: 60%; float: right;}
      
      .big-left-column { width: 60%; height: 92%; float: left; }
      .small-right-column { width: 35%; float: right;}
            
      .left-column { width: 47.5%; height: 92%; float: left; }
      .right-column { width: 47.5%; float: right;}
      

      
      
      .pull-left { float: left; width: 47%; }
      .pull-right { float: right; width: 47%; }      
      
    </style>
  </head>
  <body>
    <textarea id="source">

name: inverse
layout: true
class: center, middle, inverse

---
#.lgray[Neural dynamics of perceptual detection 
#under temporal uncertainty<br>]

<br>
### london, august 2017

###fede carnevale<br>
###zador lab @ cshl<br> 

---
layout: false
#.red[Intro]

<br>
<img class="right" src="./figs/intro2/intro-a.png"/>

---
layout: false
#.red[Intro]

<br>
<img class="right" src="./figs/intro2/intro-b.png"/>

--
<br><br><br><br>
<img class="right" src="./figs/intro2/percepts.png" width="80%"/>

---
layout: false
#.red[Intro]

<br>
<img class="right" src="./figs/intro2/intro-b.png"/>
##Attention-orienting tasks:
<img class="right" src="./figs/intro2/att.jpg"/>

---
layout: false
#.red[Intro]

<br>
<img class="right" src="./figs/intro2/intro-b.png"/>


<br>
#Temporal expectations:

#Anticipate/predict the timing of future events to optimize interaction with environment


---
layout: false
#.red[Intro]

<br>
<img class="right" src="./figs/intro2/intro-c.png" width = "140%"/>


---
layout: false
#.red[Intro]

<br><br><br>
.center[<img class="right" src="./figs/intro2/percepts-a.png" width = "140%"/>]

---
layout: false
#.red[Intro]

<br><br><br>
.center[<img class="right" src="./figs/intro2/percepts-b.png" width = "140%"/>]

---
layout: false
#.red[Intro]

<br><br><br>
.center[<img class="right" src="./figs/intro2/percepts-c.png" width = "140%"/>]

---
layout: false
#.red[Intro]

<br><br><br>
.center[<img class="right" src="./figs/intro2/percepts-d.png" width = "140%"/>]



---
layout: false
#.red[Vibrotactile Detection Task]

<!--<img class="right" src="./figs/task/figure1e.jpg"/>-->
<img class="right" src="./figs/task/figure1e-1.png" width="130%"/>
.pull-right[.footnote[de Lafuente and Romo, 2005, 2006]]
<br><br><br>
--
.pull-left[<img class="right" src="./figs/task/figure1e-2.png" width="70%">]
--
.pull-right[<img class="right" src="./figs/task/figure1e-3.png" width="70%"/>]


---
layout: false
#.red[Vibrotactile Detection Task]

<!--<img class="right" src="./figs/task/figure1e.jpg"/>-->
<img class="right" src="./figs/task/figure1e-1.png" width="130%"/>
.pull-right[.footnote[de Lafuente and Romo, 2005, 2006]]
<br><br>

.center[<img class="right" src="./figs/task/figure1e-4.png" width="70%">]


---
layout: false
#.red[Vibrotactile Detection Task]

<img class="right" src="./figs/criterion/criterion.jpg" width="70%"/>


---
layout: false
#.red[Signal Detection Theory]

<img class="right" src="./figs/sdt/signal.jpg" width="50%"/>
<br><br><br>
<img class="right" src="./figs/sdt/sdt2.jpg" width="70%"/>

---
layout: false
#.red[Signal Detection Theory]

<br><br>
<img class="right" src="./figs/sdt/sdt3bis.jpg" width="90%"/>

---
layout: false
#.red[Questions]

<br><br><br>
#1. Does the monkey learn the temporal structure of the task?
#2. If so, what is the neural mechanism?

---
layout: false
#.red[Outline]

<br><br><br>
#1. Monkeys modulate their response criterion during the trial
#2. Premotor cortex neural trajectories suggest a mechanism
#3. RNN model leads to a possible dynamical implementation

---
layout: false
#.red[Strategy]

<br>
.big-left-column[
<img class="right" src="./figs/criterion/criterion.jpg" width="100%"/>
]

.small-right-column[
<br>
##1. Lower response criterion
##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--> More FA's
##2. Delayed response
##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--> No FA-times
##3. Decision is a commitment
##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--> Look in neural data

]


---
layout: false
#.red[Premotor Cortex Activity]

<img class="right" src="./figs/pmc/figure23-1.jpg" width="100%"/>


---
layout: false
#.red[Premotor Cortex Activity]

<img class="right" src="./figs/pmc/figure23-2.jpg" width="100%"/>


---
layout: false
#.red[Premotor Cortex Activity]

<img class="right" src="./figs/pmc/mpc2.png" width="95%"/>

.pull-right[.footnote[de Lafuente and Romo, 2005, 2006]]

---
layout: false
#.red[Neural Signature of False Alarms]


.big-left-column[<br><img class="right" src="./figs/fa/figure5d.jpg" width="70%"/>]

.small-right-column[
##1. localized fluctuations
##2. resembling externally-evoked response
##3. simultaneous in several neurons
]

<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
##FA: event localized in time, irreversible, triggers a stereotypical neural trajectory, equivalent to the one evoked by external stimulation


---
layout: false
#.red[Detecting False Alarms by Template Matching]

<br>
<img class="right" src="./figs/tm/figure6a.jpg" width="100%"/>


---
layout: false
#.red[Detecting False Alarms by Template Matching]

<img class="right" src="./figs/tm/figure6f.png" width="80%"/>

---
layout: false
#.red[Probability of FA over time]

<br>
<img class="right" src="./figs/pfa/figure3b.jpg" width="90%"/>

<br>
##The probability of FA is not uniform
##&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;but increases during the period of possible stimulation.


---
layout: false
#.red[A mechanism for flexible response criterion]

<img class="right" src="./figs/sch/dynamical1.jpg" width="70%"/>

---
layout: false
#.red[A mechanism for flexible response criterion]

<img class="right" src="./figs/sch/dynamical2.jpg" width="70%"/>


---
layout: false
#.red[A mechanism for flexible response criterion]

<img class="right" src="./figs/sch/dynamical3.jpg" width="70%"/>


---
layout: false
#.red[A mechanism for flexible response criterion]

<img class="right" src="./figs/sch/dynamical4.jpg" width="70%"/>


---
layout: false
#.red[Neural circuits - dimensionality reduction]

### &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Neural circuits are high-dimensional dynamical systems.
### &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; The network activity as a function of time is a neural trajectory.

<br>
<img class="right" src="./figs/ds/figure13a.jpg" width="80%"/>

.pull-right[.footnote[Shenoy et al., 2013]]


---
layout: false
#.red[Task-related projections]

##Looking through task-relevant projections.

<br>
$$ \hspace{5cm} r\_i(T) = \beta\_i^{amp} \text{amp}(T) + \beta\_i^{choice} \text{choice}(T) + \beta\_i^{0}$$

.left-column[
<br>
<img class="right" src="./figs/ds/figure13c.jpg" width="200%"/>
]



.right-column[
<br>

<br>
$$ \begin{eqnarray} 
\text{amplitude projection: }&\bf{\beta} \_i^{amp} \nonumber \\\\\\
\text{choice projection: }& \bf{\beta} \_i^{choice}
\end{eqnarray}$$
]

<br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>
.pull-right[.footnote[Mante et al., 2013]]

---
layout: false
#.red[Neural dynamics of perceptual detection]

.center[
<video width="500" height="500" controls data-autoplay loop>
  <source src="./vids/outputfile.mp4" type="video/mp4" frameborder="0" loop="1" allowfullscreen>
</video>
]
---
layout: false
#.red[Neural dynamics of perceptual detection]

.big-left-column[<br><br><img class="right" src="./figs/dyn/figure4b.jpg" width="100%"/>]
.small-right-column[<img class="right" src="./figs/dyn/distance_toMiss.jpg" width="100%"/>]


---
layout: false
#.red[Summary - Data]

<br>
##1. A subset of FA’s can be explained by a localized event
##2. Probability of FA increases during the window of possible stimulation
<br>
##3. Possible mechanism: response criterion encoded as distance to a separatrix
##4. PMc activity consistent with the proposed mechanism

---
layout: false
#.red[RNN model]

<img class="right" src="./figs/rnn/output.jpg" width="100%"/>

.left-column[
##1. Begin with a random network
##2. Train it to do the task
##3. Study the solution 
]

--
.right-column[
`$$\begin{eqnarray}
	\tau \frac{dx_i}{dt} &=& -x_i + g \sum _{j=1}^N{J_{ij}r_j} + W^{fb}_i z+u_i  \\
	r_i &=& tanh(x_i) \\
	z &=& \sum_{i=1}^{N}W^{out}_i r_i
\end{eqnarray}$$`
]

---
layout: false
#.red[RNN model]

<img class="right" src="./figs/rnn/output.jpg" width="100%"/>

.small-left-column[
<img class="right" src="./figs/force/figure11a.jpg" width="100%"/>
]

.big-right-column[
`$$
  \begin{eqnarray}
	\textbf{W}^{out} &←& \textbf{W}^{out} - e(t) \textbf{P}(t)\textbf{r}(t) \\
	\\
	e(t) &=& z(t) - \text{target}(t) \\
	\\	
	\textbf{P} &←& \textbf{P} - \frac{\textbf{P}\textbf{r}^T\textbf{r}\textbf{P}}{1+\textbf{r}^t\textbf{P}\textbf{r}}\\
	\\  
	\\
\end{eqnarray}$$`


.footnote[Sussillo et al., 2009; Barak et al. 2013; Mante et al., 2013]

]


---
layout: false
#.red[The RNN model solves the task]
<br><br>
<img class="right" src="./figs/rnn-task/figure12a.jpg" width="100%"/>


---
layout: false
#.red[The network uses temporal information]

<img class="right" src="./figs/rnn-rc/fromNeuron2015-5.png" width="80%"/>



---
layout: false
#.red[Reverse-engineering the network]

RNN is a dynamical system: 
`$$ \Large \dot{\textbf{x}} = \textbf{F} (\textbf{x})$$`
Due to nonlinearities, its behavior is difficult to understand.

<br>
Approach .blue[(Sussillo and Barak, 2013)]:

1. Find fixed/slow points by minimizing:
`$$\Large q = \frac{1}{2} \vert \textbf{F}(\textbf{x}) \vert ^2$$`

2. Analyze linearized dynamics around them:
`$$ \Large \dot{\delta\textbf{x}} = \textbf{F}'(\textbf{x}^s) \delta \textbf{x}$$` 

---
layout: false
#.red[Reverse-engineering the network]
<br>
<img class="right" src="./figs/rnn-dyn/fromArticle.png" width="75%"/>


---
layout: false
#.red[The implicit timing is encoded in the recurrent dynamics]
<br><br>
<img class="right" src="./figs/rnn-dyn/figure10i.jpg" width="100%"/>


---
layout: false
#.red[Conclusions, caveats and comments]

<br>
## . Monkeys infer priors in the temporal domain from task structure 
## . Population encode temporal information in recurrent dynamics

--
<br>

## . Multiples mechanisms of temporal expectation and FA's
## . RNN model supervised and simplistic (although Song et al., 2016 & 2017)

--
<br>

## . RNN models to study dynamics of brain circuits (see Mante et al., 2013)
## . Tools from dynamical systems to _understand_ the solution (Barak, 2017)

---
template: inverse
#.red[Thank you]
<!-- End of Presentation-->

---
layout: false
#.red[PCA]
<br><br>
<img class="right" src="./figs/pca/pca.jpg" width="70%"/>


    </textarea>
    <div id="slideshow" />
    
  </body>
</html>
